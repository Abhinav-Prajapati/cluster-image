{"openapi":"3.1.0","info":{"title":"Image Clustering API","description":"An API for uploading, processing, and clustering images.","version":"1.0.0"},"paths":{"/images/upload":{"post":{"tags":["Images"],"summary":"Upload Images","description":"Uploads one or more image files.\n- Saves new images and triggers background processing.\n- Detects duplicates based on file hash and returns existing image data.","operationId":"uploadImages","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_uploadImages"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ImageResponse"},"type":"array","title":"Response Uploadimages"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/images/":{"get":{"tags":["Images"],"summary":"Get All Images","description":"Retrieves a list of all images in the database.","operationId":"getAllImages","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ImageResponse"},"type":"array","title":"Response Getallimages"}}}}}}},"/images/{image_id}":{"get":{"tags":["Images"],"summary":"Get Image File","description":"Returns the original image file.","operationId":"getImageFile","parameters":[{"name":"image_id","in":"path","required":true,"schema":{"type":"integer","title":"Image Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Images"],"summary":"Delete Image","description":"Deletes an image's database record and its physical files.","operationId":"deleteImage","parameters":[{"name":"image_id","in":"path","required":true,"schema":{"type":"integer","title":"Image Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/images/thumbnail/{image_id}":{"get":{"tags":["Images"],"summary":"Get Thumbnail File","description":"Returns the thumbnail file for an image.","operationId":"getImageThumbnail","parameters":[{"name":"image_id","in":"path","required":true,"schema":{"type":"integer","title":"Image Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/batches/":{"get":{"tags":["Grouping Batches"],"summary":"Get All Batches","description":"Retrieves a list of all grouping batches with full image details.","operationId":"getAllBatches","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/BatchResponse"},"type":"array","title":"Response Getallbatches"}}}}}},"post":{"tags":["Grouping Batches"],"summary":"Create Batch","description":"Creates a new, unprocessed batch by associating it with existing images.","operationId":"createBatch","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/batches/{batch_id}":{"get":{"tags":["Grouping Batches"],"summary":"Get Batch Details","description":"Gets all information about a specific batch by its ID.","operationId":"getBatch","parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Grouping Batches"],"summary":"Rename Batch","description":"Renames an existing batch.","operationId":"renameBatch","parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchRename"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Grouping Batches"],"summary":"Delete Batch","description":"Deletes an existing batch and its associations.","operationId":"deleteBatch","parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/batches/{batch_id}/images":{"post":{"tags":["Grouping Batches"],"summary":"Add Images To Batch","description":"Adds one or more images to an existing batch.","operationId":"addImagesToBatch","parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchUpdateImages"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Grouping Batches"],"summary":"Remove Images From Batch","description":"Removes one or more images from an existing batch.","operationId":"removeImagesFromBatch","parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchUpdateImages"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/batches/{batch_id}/upload-and-add":{"post":{"tags":["Grouping Batches"],"summary":"Upload And Add To Batch","description":"Uploads one or more images and adds them to a specific batch.","operationId":"uploadAndAddImagesToBatch","parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_uploadAndAddImagesToBatch"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/batches/{batch_id}/analyze":{"put":{"tags":["Grouping Batches"],"summary":"Analyze Batch","description":"Runs the grouping analysis on a batch and stores the results.","operationId":"analyzeBatch","parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchAnalyze"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/batches/{batch_id}/groups":{"put":{"tags":["Grouping Batches"],"summary":"Update Groups","description":"Manually updates the group assignments for images in a batch.","operationId":"updateGroupsInBatch","parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchGroupUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"tags":["Root"],"summary":"Read Root","description":"A simple health check endpoint.","operationId":"read_root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"BatchAnalyze":{"properties":{"eps":{"type":"number","title":"Eps","default":0.3},"min_samples":{"type":"integer","title":"Min Samples","default":2},"metric":{"type":"string","title":"Metric","default":"cosine"}},"type":"object","title":"BatchAnalyze","description":"Schema for the analysis request."},"BatchCreate":{"properties":{"name":{"type":"string","title":"Name"},"image_ids":{"items":{"type":"integer"},"type":"array","title":"Image Ids"}},"type":"object","required":["name","image_ids"],"title":"BatchCreate","description":"Schema for the initial creation of a batch."},"BatchGroupUpdate":{"properties":{"group_map":{"additionalProperties":{"items":{"type":"integer"},"type":"array"},"type":"object","title":"Group Map"}},"type":"object","required":["group_map"],"title":"BatchGroupUpdate","description":"Schema for manually updating a batch's group map."},"BatchRename":{"properties":{"name":{"type":"string","title":"Name"}},"type":"object","required":["name"],"title":"BatchRename","description":"Schema for renaming a batch."},"BatchResponse":{"properties":{"id":{"type":"integer","title":"Id"},"batch_name":{"type":"string","title":"Batch Name"},"status":{"type":"string","title":"Status"},"parameters":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Parameters"},"image_associations":{"items":{"$ref":"#/components/schemas/GroupAssociationResponse"},"type":"array","title":"Image Associations"}},"type":"object","required":["id","batch_name","status","parameters","image_associations"],"title":"BatchResponse","description":"Schema for returning full batch details."},"BatchUpdateImages":{"properties":{"image_ids":{"items":{"type":"integer"},"type":"array","title":"Image Ids"}},"type":"object","required":["image_ids"],"title":"BatchUpdateImages","description":"Schema for adding/removing images from a batch."},"Body_uploadAndAddImagesToBatch":{"properties":{"files":{"items":{"type":"string","format":"binary"},"type":"array","title":"Files"}},"type":"object","required":["files"],"title":"Body_uploadAndAddImagesToBatch"},"Body_uploadImages":{"properties":{"files":{"items":{"type":"string","format":"binary"},"type":"array","title":"Files"}},"type":"object","required":["files"],"title":"Body_uploadImages"},"GroupAssociationResponse":{"properties":{"image":{"$ref":"#/components/schemas/ImageResponse"},"group_label":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Group Label"}},"type":"object","required":["image","group_label"],"title":"GroupAssociationResponse","description":"Schema for an image's association within a batch, including its group."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ImageResponse":{"properties":{"id":{"type":"integer","title":"Id"},"filename":{"type":"string","title":"Filename"},"original_filename":{"type":"string","title":"Original Filename"},"file_path":{"type":"string","title":"File Path"},"has_thumbnail":{"type":"boolean","title":"Has Thumbnail"},"is_duplicate":{"type":"boolean","title":"Is Duplicate","default":false},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"}},"type":"object","required":["id","filename","original_filename","file_path","has_thumbnail"],"title":"ImageResponse","description":"Schema for returning image details. This model is unchanged."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}